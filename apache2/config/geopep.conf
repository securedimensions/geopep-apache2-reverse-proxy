LoadModule geopep_module /usr/lib/apache2/modules/mod_authz_geopep.so

<VirtualHost *:80>
        ServerName geopep.testbed.dev.dgplatform.click

    <Location /geoserver>
	Require all granted

        GeoPEP.WMS      on
        GeoPDP.Host     geopdp.testbed.dev.dgplatform.click
        GeoPDP.Port     443
        GeoPDP.Path     /authzforce-ce/domains/A0bdIbmGEeWhFwcKrC9gSQ/pdp
        GeoPDP.Scheme   https

        ProxyPass http://demo.secure-dimensions.de/geoserver
        ProxyPassReverse http://demo.secure-dimensions.de/geoserver
    </Location>


    <LocationMatch "/rest/services/DCS/collections/.*">
        # AllowMethods GET POST OPTIONS

        <LimitExcept OPTIONS>
                    AuthType Basic
                    AuthName "OAuth Bearer"
                    Require valid-user
        </LimitExcept>

        PerlAuthenHandler SD::OpenIDBearerHandler
        PerlOptions +ParseHeaders +SetupEnv +GlobalRequest
        PerlSetVar ClientId fa00ef4f-143d-da53-c814-ac1866d592c5@ogc.secure-dimensions.com
        PerlSetVar ClientSecret b0dec4f85327c9af80f9669f0c8f966ebc3ffaa0f5c56c244bac76802d6ba9ef
        PerlSetVar ValidateURL http://ogc.secure-dimensions.com/oauth/tokeninfo
        PerlSetVar UserinfoURL http://ogc.secure-dimensions.com/oauth/userinfo

        GeoPEP.API      on
        GeoPDP.Host     geopdp.testbed.dev.dgplatform.click
        GeoPDP.Port     443
        GeoPDP.Path     /geopdp/domains/VOAXg1SAEemsYePJ2WOgqg/pdp
        GeoPDP.Scheme   https

    </LocationMatch>
    ProxyPass /rest/services/DCS/collections http://http://wfs3.secure-dimensions.de/rest/services/DCS/collections
    ProxyPassReverse /rest/services/DCS/collections http://http://wfs3.secure-dimensions.de/rest/services/DCS/collections

    ProxyPass /rest/services/___static___ http://http://wfs3.secure-dimensions.de/rest/services/___static___
    ProxyPassReverse /rest/services/___static___ http://http://wfs3.secure-dimensions.de/rest/services/___static___

	LogLevel error
        ErrorLog /var/log/apache2/geopep-error.log
        CustomLog /var/log/apache2/geopep-access.log combined

</VirtualHost>
